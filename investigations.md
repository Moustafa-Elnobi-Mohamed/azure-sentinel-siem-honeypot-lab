Here is a **professional, SOC-style `INVESTIGATION.md`** you can place next to your README in the same GitHub repository.
This is written the way **junior SOC analysts and security engineers document investigations** — clear, structured, and credible.

---

# Investigation Report – Microsoft Sentinel Honeypot Lab

## Investigation Summary

This document details the investigation workflow performed on a **cloud-based honeypot monitored by Microsoft Sentinel**. The objective was to identify, analyze, and contextualize security events generated by an intentionally exposed virtual machine, using **KQL threat hunting techniques and log enrichment**.

All investigation activities were conducted within **Microsoft Sentinel and Log Analytics Workspace** using **Azure free credits only**.

---

## Environment Overview

* **Cloud Provider:** Microsoft Azure
* **SIEM:** Microsoft Sentinel
* **Log Source:** Windows Security Events
* **Honeypot:** Windows Server 2022 Virtual Machine
* **Log Store:** Log Analytics Workspace
* **Enrichment Source:** GeoIP Watchlist

---

## Investigation Scope

The investigation focused on:

* Authentication activity (successful and failed logons)
* Process execution behavior
* Event frequency analysis
* Potential brute-force indicators
* Geographic context of source IP addresses
* Baseline vs suspicious activity comparison

---

## Step 1: Baseline Log Verification

### Objective

Confirm that security telemetry is being ingested correctly.

### Query Used

```kql
SecurityEvent
```

### Findings

* Security events were successfully ingested.
* Events originated from the honeypot VM.
* Confirmed visibility into authentication, system, and process activity.

---

## Step 2: Event Frequency Analysis

### Objective

Identify the most common security events to establish baseline behavior.

### Query Used

```kql
SecurityEvent
| summarize Count = count() by EventID
| order by Count desc
```

### Findings

* High volume of process creation events (4688)
* Authentication-related events present
* Confirms normal OS activity combined with external interaction

---

## Step 3: Failed Authentication Analysis

### Objective

Detect potential brute-force or reconnaissance activity.

### Query Used

```kql
SecurityEvent
| where EventID == 4625
| summarize FailedAttempts = count() by IpAddress, Account
| order by FailedAttempts desc
```

### Findings

* Multiple failed authentication attempts detected
* Repeated attempts from the same IP address
* Behavior consistent with automated scanning or credential guessing

---

## Step 4: Successful Authentication Review

### Objective

Verify whether any suspicious login attempts succeeded.

### Query Used

```kql
SecurityEvent
| where EventID == 4624
| project TimeGenerated, Account, LogonType, Computer, IpAddress
| order by TimeGenerated desc
```

### Findings

* Successful logons observed were system-related
* No evidence of unauthorized external access
* No compromise indicators detected

---

## Step 5: Process Execution Investigation

### Objective

Monitor executed processes for abnormal or malicious behavior.

### Query Used

```kql
SecurityEvent
| where EventID == 4688
| project TimeGenerated, Account, Computer, NewProcessName, ParentProcessName
| order by TimeGenerated desc
```

### Findings

* Processes aligned with normal Windows Server operations
* No suspicious binaries or execution chains detected
* No evidence of post-exploitation activity

---

## Step 6: Temporal Analysis

### Objective

Understand event volume trends over time.

### Query Used

```kql
SecurityEvent
| summarize Events = count() by bin(TimeGenerated, 1h)
| order by TimeGenerated desc
```

### Findings

* Event spikes aligned with VM activity and configuration changes
* No sustained anomaly patterns observed

---

## Step 7: GeoIP Enrichment & Attribution

### Objective

Add geographic context to failed authentication attempts originating from the honeypot.

### Query Used

```kql
let GeoIPDB = _GetWatchlist("geoip");
SecurityEvent
| where EventID == 4625
| where isnotempty(IpAddress)
| evaluate ipv4_lookup(GeoIPDB, IpAddress, network)
| summarize FailureCount = count()
  by IpAddress, latitude, longitude, cityname, countryname
| project FailureCount,
         AttackerIp = IpAddress,
         latitude,
         longitude,
         city = cityname,
         country = countryname,
         friendly_location = strcat(cityname, " (", countryname, ")")
```

### Findings

* Failed login attempts were attributed to external IP addresses
* GeoIP data provided country and city-level context
* Demonstrates enrichment workflow commonly used in SOC investigations

---

## Incident Assessment

### Was an Incident Created?

No.

### Reasoning

* No successful unauthorized authentication detected
* No suspicious process execution observed
* Activity aligns with expected behavior for an exposed honeypot

---

## Risk Assessment

| Risk Factor         | Assessment                  |
| ------------------- | --------------------------- |
| External Exposure   | High (intentional honeypot) |
| Unauthorized Access | Not observed                |
| Persistence         | Not observed                |
| Impact              | None                        |
| Threat Level        | Low                         |

---

## Lessons Learned

* Microsoft Sentinel provides strong visibility even at free-tier scale
* KQL enables effective threat hunting without pre-built detections
* Honeypots are valuable for understanding real-world internet noise
* GeoIP enrichment improves analyst context and investigation clarity
* Not every suspicious event warrants an incident

---

## Recommendations

If this were a production environment:

* Enable analytic rules for repeated failed logons
* Restrict inbound access via NSG
* Implement MFA and Just-In-Time VM access
* Retain logs for longer historical analysis

---

## Conclusion

This investigation demonstrates a **complete SOC investigation workflow**:

* Log ingestion
* Threat hunting
* Enrichment
* Contextual analysis
* Risk-based decision making

All actions were performed in a **cost-controlled cloud environment**, showcasing practical security engineering and SOC analyst skills.

